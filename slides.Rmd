---
title: "MIDTERM PROJECT"
author: "Andrew Sisitzky,Chen Xu,Guangze Yu,Yuyang Li"
date: "20201 November 1"
output: 
  revealjs::revealjs_presentation:
    #template: hw_temp_1.html
    theme: sky
    highlight: pygments 
    #css: reveal.css
---


```{r setup, include=FALSE, warning=FALSE}
knitr::opts_chunk$set(echo = FALSE)
pacman::p_load("tidyverse","ggplot2","dplyr", "maps", "treemapify")
source("ultimate data wrangle and clean.R")
source("visualization function midterm.R")
```




# 

<div style= "align:center; font-size:80px;">
<p><br><br><b>
DATA WRANGLING 
</b>
</p>

</div>


## Data clean-Strawberries.csv
 - Take apart strawberries.csv and restructure, 
 - Use <i><b>Year, State, Domain, Chemical, Chemical type, Value, units </i></b>as variable to get a new table
 
 - Select data when<i><b> Domain = "CHEMICAL"</i></b>
 
## Data clean-Strawberries.csv

 - Empty rows were removed to make the data more compact
 
 - The name of various pesticides were converted to uppercase letters for later matching

## Data wrangling-left_join

 - Function <i>left_join</i> is used to match the data by <i><b>"chemicaltype = pesticide" </i></b> 
 
 - Combine them into one table for subsequent EDA
 
 - Delete the missing value if <i><b>"Year = NA"</i></b>


</section>

# 
<div style= "align:center; font-size:80px;">
<p><br><br><b>
MAKE JUDGEMENTS
</b>
</p>

</div>


## Give a level for toxins

 - <b>For human</b>
<div><br>
<table><tbody>
<tr>
<th style="width: 344px; padding: 3px; border-color: rgb(0, 0, 0);">Chemical\Level</th>
<th style="width: 151px; padding: 3px; border-color: rgb(0, 0, 0);">1</th>
<th style="width: 156px; padding: 3px; border-color: rgb(0, 0, 0);">2</th>
<th style="width: 155px; padding: 3px; border-color: rgb(0, 0, 0);">3</th>
<th style="padding: 3px; border-color: rgb(0, 0, 0);">4</th>
</tr>
<tr>
<td style="width: 344px; padding: 3px; border-color: rgb(0, 0, 0);">Carcinogen:</td>
<td style="width: 151px; padding: 3px; border-color: rgb(0, 0, 0);">unknown</td>
<td style="width: 156px; padding: 3px; border-color: rgb(0, 0, 0);">possible</td>
<td style="width: 155px; padding: 3px; border-color: rgb(0, 0, 0);">probable</td>
<td style="padding: 3px; border-color: rgb(0, 0, 0);">known</td>
</tr>
<tr>
<td style="width: 344px; padding: 3px; border-color: rgb(0, 0, 0);">Hormone.Disruptor</td>
<td style="width: 151px; padding: 3px; border-color: rgb(0, 0, 0);">unknown</td>
<td style="width: 156px; padding: 3px; border-color: rgb(0, 0, 0);">suspected</td>
<td style="width: 155px; padding: 3px; border-color: rgb(0, 0, 0);"></td>
<td style="padding: 3px; border-color: rgb(0, 0, 0);"></td>
</tr>
<tr>
<td style="width: 344px; padding: 3px; border-color: rgb(0, 0, 0);">Hormone.Disruptor</td>
<td style="width: 151px; padding: 3px; border-color: rgb(0, 0, 0);">unknown</td>
<td style="width: 156px; padding: 3px; border-color: rgb(0, 0, 0);">present</td>
<td style="width: 155px; padding: 3px; border-color: rgb(0, 0, 0);"></td>
<td style="padding: 3px; border-color: rgb(0, 0, 0);"></td>
</tr>
<tr>
<td style="width: 344px; padding: 3px; border-color: rgb(0, 0, 0);">Developmental/Reproductive Toxins</td>
<td style="width: 151px; padding: 3px; border-color: rgb(0, 0, 0);">unknown</td>
<td style="width: 156px; padding: 3px; border-color: rgb(0, 0, 0);">present</td>
<td style="width: 155px; padding: 3px; border-color: rgb(0, 0, 0);"></td>
<td style="padding: 3px; border-color: rgb(0, 0, 0);"></td>
</tr>
</tbody></table><br></div>


 -  <b>For bee</b>
 <div><br>
<table><tbody>
<tr>
<th style="width: 259px; padding: 3px;">Chemical\Level</th>
<th style="padding: 3px;">1</th>
<th style="padding: 3px;">2</th>
<th style="padding: 3px;">3</th>
<th style="padding: 3px;">4</th>
</tr>
<tr>
<td style="width: 259px; padding: 3px;">Bee.Toxins</td>
<td style="padding: 3px;">unknown</td>
<td style="padding: 3px;">slight</td>
<td style="padding: 3px;">moderate</td>
<td style="padding: 3px;">high</td>
</tr>
</tbody></table></div>


## Calculate total toxicity level
 -  <b>For human</b>
 
    + Toxicity level for human = <i>Carcinogen+HormoneDisruptor+Neurotoxins+ Developmental or Reproductive Toxins</i>
     
 -  <b>For bee</b>
 
    + Toxicity level for bee = <i>Bee.Toxins</i>  
  
## Pose our project topic

 How the human-harm pesticide usage differ as time passes in the major strawberries producing areas in the US.

</section>

# 

<div style= "align:center; font-size:80px;">
<p><br><br><b>
EDA
</b>
</p>

</div>


## Choose data for map

 - Select chemical types exist in <i><b>Pesticides.csv</i></b>
 
 - Filter dataframe into subsets in different measurements
    + MEASURED IN LB / ACRE / YEAR  AVG
    + MEASURED IN PCT OF AREA BEARING  AVG
    + MEASURED IN LB
    + MEASURED IN LB / ACRE / APPLICATION  AVG
    + MEASURED IN NUMBER  AVG
 
 - Subset the dataframe by year
    + 2016
    + 2018
    + 2019

## Choose data for plot

 - Calculate the frequency of chemical type and add a column to store the values and merge the three dataset by chemical type
 
 - Calculate the frequency of toxicity level for human for each year
 

## The map for major strawberry producing area in the US(including the mean toxicity level for human)

 - Created a map to visualize the mean toxicity for each state.
 - Took data across all years, calculated the means, and plotted the results on a map of the United States
 
 
## The map:

```{r}
map_function(eda_subset)
```

## The map for major strawberry producing area in the US(including the mean toxicity level for human)

 - We found that California and Florida on average had lower human toxicity levels than Washington and Oregon.
 - This plot shows that, based on this dataset, the harvests in Oregon tended to use chemicals that were rated higher by our toxicity scale in comparison to other states.

## Total Pesticide usage: 2016 vs. 2018 vs. 2019
 
 - After our initial analysis of our data, we plot the total pesticide usage comparison for four states from 2016 to 2019 except 2017. From the bar chart, we can see that the pesticide usage is getting lower as time passes. 
 
## Total Pesticide usage: 2016 vs. 2018 vs. 2019 plot
```{r}
chemcialtype_freq_barchart_function(chemicaltype_freq)
```


## Comparison of Pesdicide usage: 2016 vs. 2018 vs. 2019

 - After we looked at the total usage of pesticides in our previous plot, we decided that we wanted to look deeper into the usage of pesticide over the years of data that we have access to. 
 - For this plot, we looked at each chemical type and plotted its frequency of usage across 3 years.
 
## Comparison of Pesdicide usage: 2016 vs. 2018 vs. 2019 plot
```{r}
chemicaltype_freq_function(chemicaltype_freq)
```

## Comparison of Pesdicide usage: 2016 vs. 2018 vs. 2019 conclusion

 - We find that the total amount of chemical be used across the 3 years decreased
 - Now as we know the specific usage of each chemical type through 3 years. We want to dive deeper into the distribution of toxicity level that related to human for each year.

## Pesticide Toxicitylevelhuman Frequency 2016
```{r}
human_toxicity_level_function(year1_toxicityhuman_freq) + ggtitle("Pesticide Toxicitylevelhuman Frequency 2016")
```

## Pesticide Toxicitylevelhuman Frequency 2018
```{r}
human_toxicity_level_function(year2_toxicityhuman_freq) + ggtitle("Pesticide Toxicitylevelhuman Frequency 2018")
```

## Pesticide Toxicitylevelhuman Frequency 2019
```{r}
human_toxicity_level_function(year3_toxicityhuman_freq) + ggtitle("Pesticide Toxicitylevelhuman Frequency 2019")
```

## Conclusion for EDA and our posed project topic:

 - After we view all the three plots about the distribution, we conclude that althought the total amount of chemical be used across the 3 years decreased, the propotion of toxicitylevel remains relatively the same. 
 - We can say that even though the amount of chemicals they are treating the strawberries with is decreasing, those that they are using are still known to be toxic to humans.


</section>



